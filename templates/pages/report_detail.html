{% extends 'base.html' %} 
{% block title %}Reporte #{{ report_id }} | WP Scrap{% endblock %}

{% block content %}
<!-- Breadcrumb -->
<div class="breadcrumb">
  <a href="/">Dashboard</a>
  <span class="breadcrumb-separator">/</span>
  <a href="/domains">Dominios</a>
  <span class="breadcrumb-separator">/</span>
  <span>Reporte #{{ report_id }}</span>
</div>

<h1>📄 Reporte #{{ report_id }}</h1>
<p>Análisis completo del dominio en este momento específico</p>

<!-- Report Data -->
<div id="report-data-container" data-report-id="{{ report_id }}">
  <div class="loading">Cargando reporte...</div>
</div>

<!-- Actions -->

  <div class="btn-actions-wrapper">
    <div style="display: flex; gap: 12px; justify-content: center;">
      <a href="/domains" class="btn">← Volver a Dominios</a>
    </div>
  </div>

<!-- Trusted Contact Selection -->
<div class="card">
  <div class="card-header">
    <h2 style="margin: 0;">Contacto de confianza</h2>
  </div>
  <div class="card-body" id="trusted-contact-container">
    <div class="loading">Cargando contactos detectados...</div>
  </div>
</div>

<!-- IA Section -->
<div class="card">
  <div class="card-header">
    <h2 style="margin: 0;">Reporte generation - IA</h2>
  </div>
  <div class="gerenate-report-container">
    <button class="btn" type="button" data-report-type="technical">
      <p style="font-size: 32px;">🧑🏽‍💻</p>
      Generar reporte tecnico
    </button>
    <button class="btn" type="button" data-report-type="commercial">
      <p style="font-size: 32px;">📊</p>
      Generar reporte comercial
    </button>
    <button class="btn" type="button" data-report-type="deliverable">
      <p style="font-size: 32px;">📄</p>
      Generar reporte entregable
    </button>
  </div>
  <div id="report-ia-container">
    <!-- IA will be loaded here by JS -->
  </div>
</div>

<!-- Comments Section -->
<div class="card">
  <div id="report-comments-container">
    <!-- Comments will be loaded here by JS -->
  </div>
</div>


{% endblock %}

{% block extra_scripts %}
<script src="/static/js/pages/report_detail.js"></script>
<script>
  // Initialize report detail page
  $(function() {
    const reportContainer = document.getElementById('report-data-container');
    const reportIdAttr = reportContainer ? reportContainer.dataset.reportId : null;
    const parsedReportId = reportIdAttr ? Number(reportIdAttr) : null;

    if (parsedReportId && window.App && typeof window.App.initReportDetail === 'function') {
      window.App.initReportDetail(parsedReportId);
    }
  });
</script>
{% endblock %}
